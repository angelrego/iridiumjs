console&&console.info("iridium.js 0.14.0");var iridiumNamespace,iridiumStartTag,iridiumEndTag,iridium=function(t,e,n){"use strict";const r="iridium",i="{{",o="}}",a={session:"session",layerLog:"layer-log",authorization:"Authorization",data_container:"data-container",data_target:"data-target",data_model:"data-model",data_bind:"data-bind",data_value:"data-value",data_checked:"data-checked",data_status:"data-status",data_skeleton:"data-skeleton",data_provider:"data-provider",data_event:"data-event",data_load:"data-load",data_options:"data-options",data_index:"data-index",data_:"data-",create:"create",read:"read",update:"update",delete:"delete",autorefresh:"autorefresh",autosave:"autosave"},s=["allowFullscreen","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultChecked","defaultMuted","defaultSelected","defer","disabled","draggable","enabled","formNoValidate","hidden","indeterminate","inert","isMap","itemScope","loop","multiple","muted","noHref","noResize","noShade","noValidate","noWrap","open","pauseOnExit","readOnly","required","reversed","scoped","seamless","selected","sortable","spellcheck","translate","trueSpeed","typeMustMatch","visible"];function u(t,e){return e||""===e?"["+t+"='"+e+"']":"["+t+"]"}function d(t,e=[],n=window){var r=n[t];if("function"==typeof r)return r.apply(n,e)}function l(t){var e=location.href,n=e.indexOf("?");if(-1===n)return"";const r=e.substring(n+1);if(!t)return r;const i=new URLSearchParams(r);return i.has(t)?i.get(t):""}var c=async function(t,e){let n=null;e||(e={});try{p.hide();const r=!(!e.headers||!e.headers.get(a.authorization)),i=!(t.includes(":")&&!t.startsWith(window.location.origin));if(!r&&i&&E[a.authorization]&&(e.headers||(e.headers=new Headers),e.headers.get(a.authorization)||e.headers.set(a.authorization,E[a.authorization])),(n=await fetch(t,e)).status>=400){const e=new Error;throw e.status=n.status,e.statusText=n.statusText+" ("+t+")",e}const o=n.headers.get("content-type");let s;return s=o?o.includes("json")?await n.json():o.includes("text")?await n.text():await n.blob():await n.text()}catch(t){throw 401===t.status&&(ir.security().removeAuthenticated(),location.href=location.protocol+"//"+location.host+location.pathname),p.showError(t),t}};function h(t,e){null==e&&console.warn('The property "'+t+'" was not found (or it is undefined/null). The property is now created, but check if the data model should contain that key or not')}function f(t,e){"number"==typeof t&&(t=t.toString());var n=e;try{var r=t.split(".");let e=n;for(;r.length>1;){const t=r.shift();h(r,n[t]),(void 0===n[t]||null===n[t])&&r.length>0&&(n[t]={}),e=n=n[t]}return e}catch(n){return console.error("No object found when looking for key='"+t+"'."+n),e}}function m(t,e){"number"==typeof t&&(t=t.toString());var n=f(t,e);return h(t,n),void 0===n?void 0:n[t.split(".").pop()]}var p={el:()=>document.getElementById("layer-log"),clean(){this.el().innerText="",this.el().classList.remove("showOK"),this.el().classList.remove("showError")},showOK(t){this.clean(),this.el().innerText=t,t.length>100&&(t=t.substring(0,100)),this.el().classList.add("showOK"),setTimeout(()=>this.el().classList.remove("showOK"),4e3)},showError(t){let e=t.status?`${t.status}. ${t.statusText}`:t;console.error(e),this.clean(),e.length>100&&(e=e.substring(0,100)),this.el().innerText=e,this.el().classList.add("showError"),setTimeout(()=>this.el().classList.remove("showError"),4e3)},hide(){this.clean()}};var g={};async function b(t,e){delete g[t],await async function(t=document){const e=t.querySelectorAll(`[${a.data_load}]:not([${a.data_status}])`);for(let t of e){const e=t.getAttribute(a.data_load);let n=e;(n=n.startsWith("#/")?n.substring(2):n).startsWith("//")&&"file:"===window.location.protocol&&(n=window.location.protocol+"/"+n);const r=new URL(n,window.location.href);t.setAttribute(a.data_status,"loading"),w(r.href,u(a.data_load,e)).catch(t=>p.showError(t)),t.setAttribute(a.data_status,"loaded")}return e}(),e||(e="body"),y(),0===Object.keys(g).length&&O&&("function"==typeof O?O():"string"==typeof O?d(O):console.error(O+"is not a function or a string. It cannot be executed (related to '"+t+"')"))}function y(){const t=[],e=document.querySelectorAll(`[${a.data_model}]:not([${a.data_status}="inited"])`);for(let n=0;n<e.length;n++)"inited"!==e[n].getAttribute(a.data_status)&&(S(e[n].getAttribute(a.data_model)),t.push(e[n]));return t}async function v(t){for(let e of t){e.src&&e.type&&e.type.toLowerCase().includes("module")&&console.warn(`Developer error: The script tag ${e.src} is type='module'. Due to the static nature of ESM, the script is only loaded the first time.Use either import(), or remove any runtime code from the module and use it ONLY as a library. To summarize: either remove attribute module or attribute src from that tag.`);const t=document.createElement("script");for(let n of e.attributes)t.setAttribute(n.name,n.value);if(e.getAttribute("async")||e.getAttribute("defer"))e.src||(t.text=e.textContent),e.parentNode.insertBefore(t,e);else if(t.async=!1,t.setAttribute("async","false"),e.src){const n=function(){return new Promise(function(n,r){e.onload||(t.onload=function(t){n()}),e.onerror||(t.onerror=function(t){console.error(t.target.src+" could not be loaded"),n()}),e.parentNode.insertBefore(t,e)})};await n()}else t.text=e.textContent,e.parentNode.insertBefore(t,e);e.remove()}}async function w(t,e){if(g[t]=!0,console.log("loading "+t),""!==t){e=function(t,e){const n=(t,e)=>{document.querySelectorAll(e).length>1&&console.warn("Container '"+e+"' is not unique (it should be most of the cases). The content of page "+t+" will be loaded into the first one")};var r=e;if(n(t,e),!document.querySelector(e)&&(e&&!1===e.trim().startsWith("#")&&n(t,e="#"+e),!document.querySelector(e))){var i=t,o=i.indexOf("?");o>-1&&(i=i.substring(0,o)),(o=i.lastIndexOf("/"))===i.length-1&&(i=i.substring(0,o)),(o=i.lastIndexOf("/"))>-1&&(i=i.substring(o+1)),(o=i.lastIndexOf("."))>-1&&(i=i.substring(0,o)),n(t,e="#"+i),document.querySelector(e)||(n(t,e),e=u(a.data_container),n(t,e),document.querySelector(e)||(e="body",console.error("container for url "+t+" is "+r+", but there is no DOM element related to that container, using default("+e+")")))}return e}(t,e);const n=await c(t);!function(t){var e=document.querySelector(t);e&&e.querySelectorAll(u(a.data_model)).forEach(t=>{var e=t.getAttribute(a.data_model);M[e]&&M[e]._destroy()});const n=document.querySelector(t);for(;n.firstChild;)n.removeChild(n.firstChild)}(e),await async function(t,e){const n=window.document.querySelector(t),r=n.ownerDocument,i=r.createDocumentFragment(),o=i.appendChild(r.createElement("div"));let a=e.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,"<$1></$2>");o.innerHTML=a,Array.from(o.childNodes).forEach(t=>i.appendChild(t)),i.removeChild(i.firstChild);const s=i.querySelectorAll("script");return n.appendChild(i),await v(s),t}(e,n)}return await b(t,e),e}function _(t,e,n,r,i){function o(t,e,n,r){let i=e.indexOf("(");n||(n="");const o=M[t];if(o||console.error("controller "+t+" was not found when searching for "+n+" = "+e),-1===i)return e.includes("'")||e.includes('"')?e.replace(/"/g,"").replace(/'/g,""):o.model.get(e);{let s=e.substring(0,i).trim();const u=function(t,e,n,r){const i=!(!t.startsWith("on")&&!t.startsWith(a.data_+"on"));return n.substring(n.indexOf("(")+1,n.indexOf(")")).split(",").map(t=>t.trim()).map(t=>""===t?t:(t.startsWith("0")&&(t=e.model.indexOf(r)+t.substr(1)),"this"===t?i?"this":r:"event"===t?"event":void 0!==e.model.get(t)?"'"+t+"'":t))}(n,o,e,r);if(o[s]||console.error("controller "+t+" has not a function "+e+". Check if you have a typo in your function declaration."),n.startsWith("on")||n.startsWith(a.data_+"on")){return"ir.controller('"+t+"')."+s+"("+u.reduce((t,e)=>t=t+","+e)+")"}return d(s,u,o)}}return function(t,e,n){if("$queryString"===e||"$querystring"===e)return l();var i=e.indexOf(":");if(i<0)return o(t,e,r,n);var a=e.substring(0,i);if(e=e.substring(i+1),a.indexOf("$")>-1){var s=a.substring(1);if("localStorage"===s)return window.localStorage.getItem(e);if("sessionStorage"===s)return window.sessionStorage.getItem(e);if("queryString"===s)return l(e)}else{var u=a;u||(u="");try{const t=M[u];return t&&t.isReady?o(u,e,r,n):""}catch(t){return console.error(t),"ERROR"}}}(t,e,i)}function x(t,e,n,r,a){if(!e)return;const s=e.indexOf(i),u=e.indexOf(o);if(s>-1&&s>-1){const n=e.substring(s+i.length,u).trim();let l=[n];n.indexOf("|")>-1&&(l=n.split("|").map(t=>t.trim()));let c,h=_(t,l[0],0,r,a);for(let e=1;e<l.length;e++){let n=l[e];n.indexOf("(")>-1&&console.error(" incorrect format of pipe, the function name should not have parenthesis"),h=d(n,[h],ir.controller(t))}return c="object"==typeof h?JSON.stringify(h):e.substring(0,s)+h+e.substring(u+o.length),null==h&&(h=""),{oldText:e,newText:c,expression:n,value:h,index1:s,index2:u+o.length}}return null}function A(t,e){if("a"===t.nodeName.toLowerCase()){var n=e.indexOf("javascript");if(n>-1)if(0===e.substring(n+"javascript".length).replace(/ /g,"").indexOf(":"))return console.warn('"javascript:" literal was found,  but removed for security reasons'),e.replace(/javascript/g,"javascript_disabled")}return e}var O,S=function(t){function e(t,e,n){if(e.children.length>0)for(var r=0;r<e.children.length;r++){var i=e.children[r];i.attributes[a.data_model]?l(i.getAttribute(a.data_model)):i.attributes[a.data_skeleton]||c(t,i,n)}}function n(t){return function(t,e){if("BODY"===t.nodeName)return null;let n=t.parentNode;for(;n;){if(n.hasAttribute&&n.hasAttribute(e))return n.getAttribute(e);n=n.parentNode}return null}(t,a.data_model)}async function l(t){var e=u(a.data_model,t);const o=document.querySelector(e);if(!o)return void console.warn("template '"+t+" ',the selector ' '"+e+"' was not found. If you are trying to render data to HTML (templates), this is an ERROR. On the other side, if you just want to perform REST calls and process the data with javascript, this is an INFO messsage.");const s=n(o);if(!s||M[s]&&!1!==M[s].isReady){var d=function(t,e){var o=t,s=e.getAttribute(a.data_provider);if(-1===o.indexOf(i)&&(!s||-1===s.indexOf(i)))return o;const d=n(e);d&&M[d].model.obj;var l=x(d,o,0,a.data_model,e);if(l){o=l.newText;var c=u(a.data_model,o);if(document.querySelector(c))throw r+": "+c+" is already in the document";e.setAttribute(a.data_model,o)}var h=x(d,s,0,a.data_provider,e);if(h){s=h.newText,e.setAttribute(a.data_provider,s);const t=M[o];if(t&&t.isReady&&o!==t.name)throw r+": controller name: "+o+" with provider:"+s+" is colliding an existing controller. Either remove it or just overwrite it"}return o}(t,o);if(t===d){if(!1!==function(t,e){const n=t;let r=e.getAttribute(a.data_provider);const i=e.getAttribute(a.data_options);let o=M[n];if(!r){if(o)return o.isReady;e.setAttribute(a.data_provider,"{}"),r=e.getAttribute(a.data_provider)}return r&&!o?(o=W(n),M[n]=o,o.configure(r,i),!1):!1===o.isConfigured?(o.configure(r,i),!1):o.isReady}(t,o)){var h=M[t].model.obj;console.debug("painting template '"+t+"'"),c(t,o,h),"inited"!==o.getAttribute(a.data_status)&&o.setAttribute(a.data_status,"inited")}}else l(d)}}function c(t,n,r){if(function(t,e,n){function r(n){if(-1===n.value.indexOf(i))return;for(var r,o=n.value;o.indexOf(i)>-1;)r=x(t,o,0,n.name,e),o=A(e,r.newText);var u=n.name.substring(a.data_.length);e.hasAttribute(u)&&e.getAttribute(u)!==o&&e.setAttribute(u,o),s.includes(u)&&(!0===r.value?e.setAttribute(u,u):e.removeAttribute(u));const d="input"===e.nodeName.toLowerCase(),l=!!d&&"checkbox"===e.getAttribute("type");if(n.name===a.data_value)if(d&&!l){if(!e.hasAttribute(a.data_bind)){e.setAttribute(a.data_bind,r.expression),e.value=r.newText;const n=function(e){M[t].model.set(e.target.getAttribute("data-bind"),e.target.value)};e.addEventListener("change",n),e.addEventListener("input",n)}}else e.innerText=r.value;if(n.name===a.data_checked&&l&&!e.hasAttribute(a.data_bind)){e.setAttribute(a.data_bind,r.expression);const n=function(n){const r=n.target.getAttribute("data-bind"),i=!M[t].model.get(r);i?e.setAttribute("checked","checked"):e.removeAttribute("checked"),M[t].model.set(r,i)};e.addEventListener("click",n)}}!function(t,e){for(var n=0;n<e.attributes.length;n++){var s=e.attributes[n];s.value.indexOf(i)>-1&&-1===s.name.indexOf(a.data_)&&!e.dataset[s.name]&&(e.dataset[s.name]=s.value,n=0)}const u=[];for(var d=0;d<e.attributes.length;d++)u.push(e.attributes.item(d));for(var l in u.forEach(t=>r(t)),e.dataset){const n=e.dataset[l];n.includes(i)&&n.includes(":")&&n.split(i).map(t=>t.substring(0,t.indexOf(o))).filter(t=>t.includes(":")).forEach(n=>{const r=n.split(":")[0].trim();q.put(r,{element:e,attribute:a.data_+l,template:t})})}}(t,e)}(t,n),r instanceof Array&&n.hasAttribute(a.data_model)){let s,l=function(t){let e=document.activeElement;if(t.contains(e)){for(var n=[];e.parentNode&&e.parentNode!==t;){if(e.id){n.unshift("#"+e.id);break}if(e===e.ownerDocument.documentElement)n.unshift(e.tagName);else for(var r=1,i=e;i.previousElementSibling;i=i.previousElementSibling,r++)n.unshift(e.tagName+":nth-child("+r+")");e=e.parentNode}return n.join(" > ")}return null}(n),c=r,h=function(t,e,n){let r=[...n],i=r.map((t,e)=>e);if(t.hasAttribute(a.data_options)){const o=t.getAttribute(a.data_options).split("|");for(let t of o)(t=t.trim())!==a.autorefresh&&t!==a.autosave&&(n instanceof Array?(r=d(t,[r],ir.controller(e)),i=r.map(t=>n.findIndex(e=>e===t))):console.error("the object must be an array to execute "+t+"()"))}return i}(n,t,r),f=n.querySelector(u(a.data_skeleton));if(!f)if("select"===n.tagName.toLowerCase())n.hasAttribute(a.data_skeleton)||(n.setAttribute(a.data_skeleton,n.innerHTML),n.setAttribute(a.data_index,i+"0"+o));else{for((f=document.createElement("div")).style.display="none",f.setAttribute(a.data_skeleton,"");n.children.length>0;)f.appendChild(n.children[0]);f.firstElementChild.setAttribute(a.data_index,i+"0"+o),n.appendChild(f)}s=n.hasAttribute(a.data_skeleton)?n.getAttribute(a.data_skeleton):f.innerHTML;let m="";if(h.forEach(t=>{const e=new RegExp(i+"\\s*\\d+\\s*","g");m+=s.replace(e,i+t)}),n.innerHTML=m,!n.hasAttribute(a.data_skeleton)){let t=f.querySelectorAll(u(a.data_model));for(let e=0;e<t.length;e++)t[e].setAttribute(a.data_status,"inited");n.innerHTML=n.innerHTML+f.outerHTML}if(e(t,n,c),l){const t=n.querySelector(l);t&&t.focus()}}else!function(t,e,n){if("SCRIPT"!==e.tagName)for(var r=e.childNodes,s=0;s<r.length;s++){var u=r[s];if(3==u.nodeType){if(-1===u.data.indexOf(i))continue;var d=x(t,u.data,0,null,e);if(d){var l=document.createTextNode(d.oldText.substring(0,d.index1)),c=document.createElement("span");c.setAttribute(a.data_value,i+d.expression+o),c.textContent=d.value;var h=document.createTextNode(d.oldText.substring(d.index2));u.parentNode.insertBefore(l,u),u.parentNode.insertBefore(c,u),u.parentNode.insertBefore(h,u),u.parentNode.removeChild(u),s=0}}}}(t,n),e(t,n,r)}l(t)},E={},j={},T=function(){var t={},e=r+".session";function n(t,e){for(var n=t.split("."),r=e,i=0;i<n.length-1;i++)r[n[i]]||(r[n[i]]={}),r=r[n[i]];return r}return sessionStorage&&sessionStorage.getItem(e)&&(t=JSON.parse(sessionStorage.getItem(e))),{get:function(e){return function(e){return n(e,t)[e]}(e)},set:function(r,i){!function(r,i){n(r,t)[r]=i,sessionStorage&&sessionStorage.setItem(e,JSON.stringify(t))}(r,i)}}}(),k=function(t){if(j[t])return j[t];var e=function(){},n={configure:function(t){e=t},run:function(t){e(t)},remove:function(){delete j[t]}};return j[t]=n,n},N={router:void 0,func:void 0,new:!1},C=!0;function L(){var t=location.hash;if(!(t.length>1&&1!=t.indexOf("/"))||(document.getElementById(t.substring(1))||console.warn("The document has not a "+t+" tag. If you are routing, the url syntax is #/"+t.substr(1)+" (note the / after #)"),C)){if("#"!==t&&"#/"!==t||(t=""),C&&""!==t?(console.log("processing router FIRST time "+location.hash+" default router '' will be loaded "),O=L,t=""):(O=void 0,console.log("processing router  '"+location.hash+"'"),!0===N.new&&N.router===t&&(O=N.func,N.new=!1)),C=!1,p.hide(),""===t)j[""]||k("").configure(function(){w("")}),j[""].run();else{var e=document.querySelectorAll(u("href",t));e.length>1&&console.warn("duplicated href elements("+t+"), maybe they target different containers."),e.length<1&&console.warn("no target is defined for hash '"+t+"'");var n,r,i=t.substring(2),o=i,s=o.indexOf("?");s>-1&&(n=o.substring(s+1),o=o.substring(0,s)),1==e.length&&e[0].hasAttribute(a.data_target)&&(r=e[0].getAttribute(a.data_target));var d=j[o];d?d.run(n):w(i,r)}y()}}var q={obj:{},get:function(t){return this.obj[t]||[]},put:function(t,e){Array.isArray(this.obj[t])||(this.obj[t]=[]);let n=this.obj[t];for(let t=0;t<n.length;t++)n[t]||n[t].element||(n.splice(t,1),t=0);n.push(e)},clean:function(t){delete this.obj[t]},updateSubscriptor:function(t){var e=t.element;if(!e)return;var n=t.attribute;const r=n.substring(a.data_.length);let o=t.element.getAttribute(n);if(!o)return;if(-1===o.indexOf(i))return;if(r.startsWith("on")&&""!==e.getAttribute(r))return;let s,u=o;for(;u.indexOf(i)>-1;)u=A(e,(s=x(t.template,u,ir.model("subscriptor").obj,n,e)).newText);n===a.data_value?e.textContent=u:e.setAttribute(r,u)}};const I={};class R{constructor(t){this.topic=t,this.subscriptions=[],this.listener=this.createHandler()}publish(t,e){document.dispatchEvent(new CustomEvent(this.topic,{detail:t}))}subscribe(t,e){if(this.subscriptions.length<=0&&document.addEventListener(this.topic,this.listener),e){const t=this.subscriptions.findIndex(t=>t.id===e);t>-1&&this.subscriptions.splice(t,1)}this.subscriptions.push(new $(this.topic,t,e))}unsubscribe(t){this.subscriptions=this.subscriptions.filter(e=>null!=e&&e.id!=t),this.subscriptions.length<=0&&document.removeEventListener(this.topic,this.listener)}clean(){this.subscriptions=this.subscriptions.filter(t=>t.isActive)}createHandler(){var t=this;return function(e){t.clean(),t.subscriptions.forEach(t=>t.fn(e))}}}class ${constructor(t,e,n){this.type=t,this.fn=e,this.id=n,this.isSelector=!!n&&!!n.substring(0,1).match(/[.\>#\[]/g)}get isActive(){return!this.isSelector||!!document.querySelector(this.id)}}var z=function(t,e){return{name:t,_obj:{},get obj(){return this._obj},set obj(t){this._obj=t;for(let t of q.get(this.name))q.updateSubscriptor(t)},get:function(t){let e=m(t,this.obj);return null==e?"":e},set:function(t,n){return m(t,this.obj)!==n?(function(t,e,n){var r=f(t,n);h(t,e),r[t.split(".").pop()]=e}(t,n,this.obj),e._fireChanges()):e._fireNothing()},add:function(t,n){var r=f(t,this.obj);return Array.isArray(r)?r.splice(t,0,n):r[t]=n,e._fireChanges()},delete:function(t){var n=f(t,this.obj);return Array.isArray(n)?n.splice(t,1):delete n[t],e._fireChanges()},get length(){return void 0===this.obj||null===this.obj?-1:this.obj.length},indexOf:function(t){let e=t;for(;e;){if(e.hasAttribute(a.data_index)){const t=/\d+/g.exec(e.getAttribute(a.data_index));return parseInt(t)}e=e.parentElement}return null}}};const M={};var W=function(t){function e(t){this.name=t,this.url=void 0,this.model=z(t,this),this.template=u(a.data_model,this.name),this.view=document.querySelector(this.template),this.isConfigured=!1,this.isReady=!1,this.options="",this.intervals=[]}if(e.prototype.extend=function(t){const e=["create","read","update","delete"];for(let n of Object.keys(t))this.hasOwnProperty(n)&&!1===e.includes(n)?console.error(`controller: ${this.name}, you cannot override a non-prototype method, method: ${n}`):this[n]=t[n];return this},e.prototype.paint=async function(){y().includes(this.name)||await _fireChanges()},e.prototype.create=async function(){var t=this.url,e=H(t);if(e){let n=t.substring(t.indexOf("/")+1);e.setItem(n,JSON.stringify(this.model.obj))}else await c(this.url,{method:"post",body:JSON.stringify(this.model.obj)}),p.showOK("created");return this},e.prototype._create=e.prototype.create,e.prototype.read=async function(){var t=!1;if("object"==typeof this.url)t=!0;else if(this.url.startsWith("{")||this.url.startsWith("["))try{this.url=JSON.parse(this.url),t=!0}catch(e){console.error("Controller '"+this.name+"'. The provider is not an URL neither an object ('"+this.url+"')"),t=!1}if(t)return this.isReady=!0,this.model.obj=this.url,await this._fireChanges(),this;var e=x(this.name,this.url,this.model.obj,null,this.view);e&&(this.url=e.newText);var n=this.url,r=H(n);if(r){let t,e=n.substring(n.indexOf("/")+1);t="s"===this.name.substring(e.length-1).toLowerCase()?"[]":"{}";let i=r.getItem(e);i||(i=t,r.setItem(e,i)),this.model.obj=JSON.parse(i)}else this.model.obj=await c(n);return this.isReady=!0,await this._fireChanges(),this},e.prototype._read=e.prototype.read,e.prototype.update=async function(){var t=this.url,e=H(t);if(e){let n=t.substring(t.indexOf("/")+1);e.setItem(n,JSON.stringify(this.model.obj))}else await c(this.url,{method:"put",body:JSON.stringify(this.model.obj)}),p.showOK("updated");return this},e.prototype._update=e.prototype.update,e.prototype.delete=async function(){var t=this.url,e=H(t);if(e){let n=t.substring(t.indexOf("/")+1);e.removeItem(n)}else await c(this.url,{method:"delete"});return p.showOK("deleted"),this},e.prototype._delete=e.prototype.delete,e.prototype.add=async function(t,e){return this.model.add(t,e),this},e.prototype.remove=async function(t){let e=this.name,n=this.model;if(!Array.isArray(n.obj)){const t="Remove an object property is not a good idea";throw console.warn(t),new Error(t)}let r=null,i=t;for(;i&&!r;){let t=i.parentElement;t.hasAttribute(a.data_model)&&t.getAttribute(a.data_model)===e&&(r=i),i=t}if(!r){const t="Error when removing element in template '"+e+"'. The child row was not found.";throw console.error(t),new Error(t)}{let t=0;for(let e=0;e<r.parentElement.children.length;e++){if(r.parentElement.children[e]===r){n.delete(t);break}t++}}return this},e.prototype.configure=function(t,e,n){if(this.url=t,n&&this.extend(n),this.options=e||"",this.isConfigured=!0,this.options.indexOf(a.autorefresh)>-1){const t=setInterval(()=>this.read(),1e3);return this.intervals.push(t),this.read()}return this.read()},e.prototype._destroy=function(){this.intervals.forEach(t=>clearInterval(t)),this.intervals=[],q.clean(this.name),delete M[this.name]},e.prototype._fireNothing=async function(){return this},e.prototype._fireChanges=async function(){const t=this;t.options&&t.options.indexOf("autosave")>-1?await t.update().then(t=>S(t.name)):await S(t.name);for(let e of q.get(t.name))q.updateSubscriptor(e);return t},M[t])return M[t];var n=new e(t);return M[t]=n,n};function H(t){return"string"!=typeof t?null:t.startsWith("localStorage/")?localStorage:t.startsWith("sessionStorage/")?sessionStorage:null}var B,J=function(){return{isAuthenticated:function(){return!!E[a.authorization]},setAuthenticated:function(t){E[a.authorization]=t,document.cookie=a.authorization+"="+t},getAuthenticated:function(){return E[a.authorization]},removeAuthenticated:function(){delete E[a.authorization],document.cookie=a.authorization+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}}}();return document.addEventListener("click",function(t){if(t.target.matches&&(t.target.matches(`a[${a.data_event}]`)||t.target.parentElement&&t.target.parentElement.matches(`a[${a.data_event}]`))){const e="A"===t.target.nodeName?t.target:t.target.parentElement;if(N.router=e.getAttribute("href"),N.func=e.getAttribute(a.data_event),N.new=!0,e.getAttribute("href")===location.hash){const t=location.href.includes("?")?"&":"?";location.href=location.href+t}}}),window.addEventListener("hashchange",L),B=document.cookie.match("(^|;) ?"+a.authorization+"=([^;]*)(;|$)"),E[a.authorization]=B?B[2]:null,{start:async function(){null===document.querySelector(u(a.data_container))&&console.warn("A tag with attribute "+a.data_container+" should be defined, to provide a default container when a page is loaded"),function(){const t=document.createElement("style");t.innerHTML=`:not(body)[data-model]:not([${a.data_status}='inited']){visibility:hidden;}`,document.body.insertBefore(t,document.body.firstChild)}(),function(){if(!document.getElementById(a.layerLog)){const t="\n        <style>\n          #layer-log {display: none; position: fixed; width:30%; margin: 0 0 0 -15%; left:50%;text-align:center; z-index:100000; top:0%; font-weight:bold; padding:0.0em; border-radius:3px}\n          #layer-log.showOK { display: block; color: black; background-color: lime; animation-name: show; animation-duration: 4s;}\n          #layer-log.showError{ display: block; color: white; background-color: red; animation-name: show;animation-duration: 4s;}\n          @keyframes show { 0% {opacity: 0} 50% {opacity: .9 } 75% {opacity: .9 }  100% {opacity: 0}}\n        </style>\n      ",e='<div id="'+a.layerLog+'" ></div>';document.body.insertAdjacentHTML("afterBegin",t+"\n"+e)}}(),document.body.hasAttribute(a.data_model)||document.body.setAttribute(a.data_model,"iridium-default"),L()},queryString:function(t){return l(t)},ajax:async function(t,e){return c(t,e)},load:async function(t,e){w(t,e)},onAvailable:function(t,e,n,r){!function t(e,n,r=1e3,i){n||(n=window),void 0!==n[e]?i():(r-=10,setTimeout(function(){t(e,n,r,i)},10))}(t,e,n,r)},run:function(t,e,n){d(t,e,n)},session:function(){return T},security:function(){return J},router:function(t){return k(t)},model:function(t){return W(t).model},controller:function(t){return W(t)},subscriptions:q,event:function(t){return function(t){return I[t]||(I[t]=new R(t)),I[t]}(t)}}}(),$ir=iridium,ir=$ir;document.addEventListener("DOMContentLoaded",function(){iridium.start(iridiumNamespace,iridiumStartTag,iridiumEndTag)});
